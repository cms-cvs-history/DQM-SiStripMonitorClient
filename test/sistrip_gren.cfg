process TIFDQMSOURCES = {

  service = MessageLogger {
      untracked vstring destinations = { "cout" }
      untracked PSet cout = { untracked string threshold = "INFO" }
      untracked vstring debugModules   = { "SiStripZeroSuppression", "SiStripClusterizer"}
  }

  service = AdaptorConfig {}

  source = PoolSource {
    untracked vstring fileNames = {
      "rfio:/castor/cern.ch/cms/store/data/GlobalSep07/C/000/020/994/RAW/0000/A0863B4F-EE6D-DC11-87C2-000423D6CA42.root",
      "rfio:/castor/cern.ch/cms/store/data/GlobalSep07/C/000/020/994/RAW/0000/30F8390A-ED6D-DC11-AC9C-000423D999BA.root"
    }
  }
  untracked PSet maxEvents = {untracked int32 input = -1}
  # magnetic field

  #-------------------------------------------------
  ## CALIBRATION
  #-------------------------------------------------


    es_source = SiStripFedCablingFakeESSource {
        FileInPath DetIdsFile = "CalibTracker/SiStripCommon/data/SiStripDetInfo.dat"
        FileInPath FedIdsFile = "CalibTracker/SiStripCommon/data/SiStripFedIdList.dat"
    }
    ## FAKE CONDITIONS
   include "CalibTracker/Configuration/data/SiStrip_FakePedestals.cfi"
   include "CalibTracker/Configuration/data/SiStrip_FakeNoise.cfi"
   include "CalibTracker/Configuration/data/SiStrip_FakeGain.cfi"
   include "CalibTracker/Configuration/data/SiStrip_FakeLorentzAngle.cfi"
   include "CalibTracker/Configuration/data/Tracker_FakeAlignment.cfi"
   include "CalibTracker/SiStripESProducers/data/SiStripQualityFakeESSource.cfi"

   es_module sistripconn = SiStripConnectivity {}
#   service = SiteLocalConfigService {}

    #-----------------------------------------------------------------------------------
    ####  Reconstruction Modules (for raw data Only. Not needed is data are unpacked)
    #------------------------------------------------------------------------------------

    include "EventFilter/SiStripRawToDigi/data/SiStripDigis.cfi"
    replace SiStripDigis.ProductLabel="source"

    include "RecoLocalTracker/SiStripZeroSuppression/data/SiStripZeroSuppression.cfi"

    include "RecoLocalTracker/SiStripClusterizer/data/SiStripClusterizer_RealData.cfi"


    #--------------------------
    #### DQM
    #--------------------------
    # DQM services
    service = DaqMonitorROOTBackEnd{}

    # tracer service - very verbose - useful for debugging only
    #  service = Tracer { untracked string indention = "$$"}

    # can comment out MonitorDeamon if you want to run without DQMCollector - this should go as include in DQMServices
    #  include "DQM/SiStripMonitorCluster/data/MonitorDaemon.cfi"
    #  replace MonitorDaemon.DestinationAddress = "pccms56.pi.infn.it"
    #  replace MonitorDaemon.UpdateDelay = 5000

    service = DQMShipMonitoring{
   	//event-period for shipping monitoring to collector (default: 25)
     untracked uint32 period = 1000
    }

    #### MonitorPedestal #### (used Only for non zero-suppressed data)
    # SiStripMonitorPedestals
    include "DQM/SiStripMonitorPedestals/data/SiStripMonitorPedestals.cfi"
    replace PedsMon.OutputMEsInRootFile = false
    replace PedsMon.RunTypeFlag = "CalculatedPlotsOnly"

    #### SiStripMonitorDigi ####
    include "DQM/SiStripMonitorDigi/data/SiStripMonitorDigi_RealData.cfi"
    # use the following flag to select all detectors (e.g. for mtcc data). by default is false
    replace SiStripMonitorDigi.SelectAllDetectors = true

    #### SiStripMonitorCluster ####
    include "DQM/SiStripMonitorCluster/data/SiStripMonitorCluster.cfi"
    # use the following flag to select all detectors (e.g. for mtcc data). by default is false
    replace SiStripMonitorCluster.FillSignalNoiseHistos = false
    replace SiStripMonitorCluster.OutputMEsInRootFile = false
    replace SiStripMonitorCluster.UseCalibDataFromDB = true # this is for the noise service
    replace SiStripMonitorCluster.SelectAllDetectors = true

    ####  SiStripMonitorAnalyser) ####
    module sistripAnalyser = SiStripAnalyser {
      untracked int32  StaticUpdateFrequency = -1
      untracked int32  TkMapCreationFrequency = 2
      untracked int32  SummaryCreationFrequency = 2
    }

    #### Quality Tester ####
    module qTester = QualityTester {
      untracked string qtList = "sistrip_qualitytest_config.xml"
      untracked bool getQualityTestsFromFile = true	        
      untracked int32 QualityTestPrescaler = 200
    }

    #### Monitor Daemon ##### (commenting out, till collector problem is solved!)
    #include "DQMServices/Examples/test/dqm_monitorDaemon.cfi"

    #replace MonitorDaemon.UpdateDelay = 500
    #replace MonitorDaemon.maxAttempts2Reconnect = 99999
    #replace MonitorDaemon.NameAsSource = "SiStrip"

    ## official DQMCollector for GREN
    #replace MonitorDaemon.DestinationAddress = "srv-c2d05-19"

   

    #### BEGIN DQM Online Environment #####
    # use include file for dqmEnv dqmSaver
    include "DQMServices/Components/test/dqm_onlineEnv.cfi"
    # put your subsystem name here: 
    # DT, Ecal, Hcal, SiStrip, Pixel, RPC, CSC, L1T 
    # (this goes into the filename)
    replace dqmSaver.fileName = "SiStrip"
    replace dqmSaver.dirName       = "."
    # (this goes into the foldername)
    replace dqmEnv.subSystemFolder = "SiStrip"

    # optionally change fileSaving  conditions
    # replace dqmSaver.prescaleLS =   -1
    # replace dqmSaver.prescaleTime = -1 # in minutes
    # replace dqmSaver.prescaleEvt =  -1
    replace dqmSaver.saveAtRunEnd = true
    # replace dqmSaver.saveAtJobEnd = false
    # will add switch to select histograms to be saved soon
   

   service = ModuleWebRegistry { }


   service = LockService {
     untracked vstring labels = { "source" }
   }
  #----------------------------
  #### Scheduling
  #-----------------------------


  sequence digitization   = {SiStripDigis,siStripZeroSuppression}
  sequence clusterization = {siStripClusters}

      
  path p = {digitization, SiStripMonitorDigi, qTester,sistripAnalyser, dqmSaver }
}
